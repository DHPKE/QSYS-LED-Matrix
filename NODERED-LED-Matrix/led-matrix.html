<script type="text/javascript">
    RED.nodes.registerType('led-matrix', {
        category: 'output',
        color: '#4a9eff',
        defaults: {
            name: { value: "" },
            ip: { value: "10.1.1.24", required: true },
            port: { value: 21324, required: true, validate: RED.validators.number() }
        },
        inputs: 1,
        outputs: 1,
        icon: "font-awesome/fa-th-large",
        label: function() {
            return this.name || `LED Matrix`;
        },
        labelStyle: function() {
            return this.name ? "node_label_italic" : "";
        }
    });
</script>

<script type="text/html" data-template-name="led-matrix">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="LED Matrix Controller">
    </div>
    
    <div class="form-row">
        <label for="node-input-ip"><i class="fa fa-globe"></i> IP Address</label>
        <input type="text" id="node-input-ip" placeholder="10.1.1.24">
    </div>
    
    <div class="form-row">
        <label for="node-input-port"><i class="fa fa-plug"></i> UDP Port</label>
        <input type="number" id="node-input-port" placeholder="21324" min="1" max="65535">
    </div>
</script>

<script type="text/html" data-help-name="led-matrix">
    <p>Control LED Matrix display with simplified flat message structure.</p>
    
    <h3>Text Display</h3>
    <p>Send text to a segment:</p>
    <pre>msg.text = "Hello World";
msg.segment = 0;           // 0-3
msg.color = "FF0000";      // Red
msg.bgcolor = "000000";    // Black background</pre>
    
    <p>Or use payload:</p>
    <pre>msg.payload = "Hello";
msg.segment = 0;</pre>

    <h3>Layout</h3>
    <p>Change layout preset:</p>
    <pre>msg.layout = 7;  // Quad view</pre>
    
    <p>Presets: 1-7, 11-14</p>

    <h3>Brightness</h3>
    <p>Set display brightness:</p>
    <pre>msg.brightness = 128;  // 0-255</pre>

    <h3>Clear</h3>
    <p>Clear a segment:</p>
    <pre>msg.clear = 0;  // Clear segment 0</pre>
    
    <p>Clear all segments:</p>
    <pre>msg.clear = "all";  // or msg.clear = true</pre>

    <h3>Orientation</h3>
    <p>Set display orientation:</p>
    <pre>msg.orientation = 0;  // 0, 90, 180, 270</pre>

    <h3>Group</h3>
    <p>Define segment groups:</p>
    <pre>msg.group = 1;
msg.segments = [0, 1];  // Segments in group</pre>

    <h3>Config</h3>
    <p>Get configuration:</p>
    <pre>msg.config = {
    network: true,     // Include network info
    name: true,        // Include device name
    orientation: true  // Include orientation
};</pre>

    <h3>Message Properties</h3>
    <dl class="message-properties">
        <dt>text <span class="property-type">string</span></dt>
        <dd>Text to display (alternative: payload)</dd>
        
        <dt>layout <span class="property-type">number</span></dt>
        <dd>Layout preset (1-7, 11-14)</dd>
        
        <dt>brightness <span class="property-type">number</span></dt>
        <dd>Display brightness (0-255)</dd>
        
        <dt>clear <span class="property-type">number|string|boolean</span></dt>
        <dd>Clear segment (0-3) or "all"/true for entire display</dd>
        
        <dt>segment <span class="property-type">number</span></dt>
        <dd>Target segment (0-3) for text/clear</dd>
        
        <dt>color <span class="property-type">string</span></dt>
        <dd>Text color hex (FFFFFF)</dd>
        
        <dt>bgcolor <span class="property-type">string</span></dt>
        <dd>Background color hex (000000)</dd>
        
        <dt>font <span class="property-type">string</span></dt>
        <dd>Font: "arial" or "mono"</dd>
        
        <dt>align <span class="property-type">string</span></dt>
        <dd>Alignment: "L", "C", "R"</dd>
        
        <dt>intensity <span class="property-type">number</span></dt>
        <dd>Text intensity (0-255)</dd>
        
        <dt>orientation <span class="property-type">number</span></dt>
        <dd>Display orientation (0, 90, 180, 270)</dd>
        
        <dt>group <span class="property-type">number</span></dt>
        <dd>Group number (0-8)</dd>
        
        <dt>segments <span class="property-type">array</span></dt>
        <dd>Segments in group [0,1,2,3]</dd>
        
        <dt>config <span class="property-type">object</span></dt>
        <dd>Config request options</dd>
    </dl>

    <h3>Examples</h3>
    <pre>// Simple text
msg.payload = "Hello";

// Colored text on segment 2
msg.text = "Temp: 22Â°C";
msg.segment = 2;
msg.color = "00FF00";

// Change layout
msg.layout = 7;

// Dim display
msg.brightness = 50;

// Clear segment 0
msg.clear = 0;

// Clear everything
msg.clear = "all";</pre>
</script>
